# ğŸ¬ Blazor film veritabanÄ± uygulamasÄ± (BÃ¶lÃ¼m 6 - Arama ekleme)

## ğŸ§° AraÃ§ SeÃ§imi

Bu makale, bir film veritabanÄ±nÄ± yÃ¶netme Ã¶zelliklerine sahip bir ASP.NET Core Blazor Web UygulamasÄ± oluÅŸturmanÄ±n temellerini Ã¶ÄŸreten **Blazor film veritabanÄ± uygulamasÄ± Ã¶ÄŸreticisinin altÄ±ncÄ± bÃ¶lÃ¼mÃ¼**dÃ¼r.

Bu bÃ¶lÃ¼m, **Movies Index** bileÅŸenine filmleri baÅŸlÄ±ÄŸa gÃ¶re filtreleyen **arama Ã¶zelliÄŸini** eklemeyi kapsar.

---

## ğŸ” QuickGrid bileÅŸenine filtre Ã¶zelliÄŸi ekleme

**QuickGrid** bileÅŸeni, veritabanÄ±ndan filmleri gÃ¶rÃ¼ntÃ¼lemek iÃ§in **Movies Index** bileÅŸeni (`Components/MoviePages/Index.razor`) tarafÄ±ndan kullanÄ±lÄ±r:

```razor
<QuickGrid Class="table" Items="context.Movie">
    ...
</QuickGrid>
```

**Items** parametresi, her satÄ±rda temsil edilen veri tÃ¼rÃ¼nÃ¼ (Movie) ifade eden `IQueryable<TGridItem>` alÄ±r.

Items, oluÅŸturulan veritabanÄ± baÄŸlamÄ±ndan (`CreateDbContext`) elde edilen film varlÄ±klarÄ± koleksiyonuna (`DbSet<Movie>`) atanÄ±r. Bu baÄŸlam, eklenen veritabanÄ± baÄŸlamÄ± fabrikasÄ±ndan (`DbFactory`) alÄ±nÄ±r.

---

## ğŸ§© Film baÅŸlÄ±ÄŸÄ±na gÃ¶re filtreleme iÃ§in yapÄ±lmasÄ± gerekenler

**Index** bileÅŸeni aÅŸaÄŸÄ±daki adÄ±mlarÄ± izlemelidir:

1. **Sorgu dizesinden (query string)** bir filtre parametresi ayarla.
2. Parametre bir deÄŸere sahipse, dÃ¶ndÃ¼rÃ¼len filmleri bu deÄŸere gÃ¶re filtrele.
3. KullanÄ±cÄ±nÄ±n filtre dizesini girmesi ve filtreyi kullanarak yeniden yÃ¼kleme baÅŸlatmasÄ± iÃ§in bir **giriÅŸ alanÄ± ve dÃ¼ÄŸme** saÄŸla.

---

## ğŸ’» Kod ekleme

AÅŸaÄŸÄ±daki kodu **Index bileÅŸeninin @code bloÄŸuna** ekle (`MoviePages/Index.razor`):

```csharp
[SupplyParameterFromQuery]
private string? TitleFilter { get; set; }

private IQueryable<Movie> FilteredMovies => 
    context.Movie.Where(m => m.Title!.Contains(TitleFilter ?? string.Empty));
```

* **TitleFilter** filtre dizesidir.
* `[SupplyParameterFromQuery]` niteliÄŸi, Blazorâ€™a **TitleFilter** deÄŸerinin sorgu dizesinden alÄ±nacaÄŸÄ±nÄ± belirtir.

  Ã–rneÄŸin, `?titleFilter=road+warrior` sorgu dizesi `TitleFilter` deÄŸiÅŸkenine **road warrior** deÄŸerini atar.

  (Sorgu dizesi alan adlarÄ±  **bÃ¼yÃ¼k/kÃ¼Ã§Ã¼k harfe duyarlÄ± deÄŸildir** .)
* **FilteredMovies** Ã¶zelliÄŸi, QuickGridâ€™in **Items** parametresine atanabilecek tÃ¼rde (`IQueryable<Movie>`) bir koleksiyondur.

  Bu Ã¶zellik, verilen **TitleFilter** deÄŸerine gÃ¶re film listesini filtreler.

  EÄŸer **TitleFilter** deÄŸeri yoksa, `string.Empty` kullanÄ±lÄ±r ve hiÃ§bir film filtrelenmez (tÃ¼m filmler gÃ¶rÃ¼ntÃ¼lenir).

---

## ğŸ§¾ QuickGrid gÃ¼ncellemesi

QuickGrid bileÅŸenindeki **Items** parametresini aÅŸaÄŸÄ±daki ÅŸekilde deÄŸiÅŸtir:

```diff
- <QuickGrid Class="table" Items="context.Movie">
+ <QuickGrid Class="table" Items="FilteredMovies">
```

---

## ğŸ§  Lambda ifadeleri ve LINQ

`movie => movie.Title!.Contains(...)` kodu bir  **lambda ifadesidir** .

Lambdalar,  **Where** , **Contains** veya **OrderBy** gibi standart sorgu operatÃ¶rlerine argÃ¼man olarak verilen **LINQ sorgularÄ±nda** kullanÄ±lÄ±r.

LINQ sorgularÄ± tanÄ±mlandÄ±ÄŸÄ±nda veya  **Where** , **Contains** gibi metodlar Ã§aÄŸrÄ±ldÄ±ÄŸÄ±nda hemen yÃ¼rÃ¼tÃ¼lmez.

Sorgu yalnÄ±zca **gerÃ§ek deÄŸeri elde edilirken (Ã¶rneÄŸin bir dÃ¶ngÃ¼de)** Ã§alÄ±ÅŸtÄ±rÄ±lÄ±r.

---

## âš™ï¸ VeritabanÄ± davranÄ±ÅŸÄ±

* **Where** metodu **veritabanÄ± Ã¼zerinde** Ã§alÄ±ÅŸÄ±r, C# kodu iÃ§inde deÄŸil.
* Sorgunun  **bÃ¼yÃ¼k/kÃ¼Ã§Ã¼k harf duyarlÄ±lÄ±ÄŸÄ±** , kullanÄ±lan veritabanÄ±na ve **collation** ayarÄ±na baÄŸlÄ±dÄ±r:
  * **SQL Server** â€™da `Contains` â†’ SQL `LIKE` ifadesine dÃ¶nÃ¼ÅŸÃ¼r ( **bÃ¼yÃ¼k/kÃ¼Ã§Ã¼k harf duyarsÄ±zdÄ±r** ).
  * **SQLite** varsayÄ±lan ayarlarla bazen duyarlÄ±, bazen duyarsÄ±z filtreleme yapar.

---

## â–¶ï¸ UygulamayÄ± Ã§alÄ±ÅŸtÄ±r

UygulamayÄ± Ã§alÄ±ÅŸtÄ±r ve `/movies` adresine git.

VeritabanÄ±ndaki filmler yÃ¼klenecektir.

---

## ğŸŒ URLâ€™ye sorgu dizesi ekleme

Adres Ã§ubuÄŸundaki URLâ€™ye ÅŸu sorgu dizesini ekle:

```
?titleFilter=Road+Warrior
```

Tam URL Ã¶rneÄŸi (port numarasÄ± 7073 ise):

```
https://localhost:7073/movies?titleFilter=Road+Warrior
```

Bu sayede yalnÄ±zca **"The Road Warrior"** filmi filtrelenip gÃ¶rÃ¼ntÃ¼lenir.

---

## ğŸ§­ KullanÄ±cÄ±larÄ±n arama yapabilmesi iÃ§in arayÃ¼z ekleme

KullanÄ±cÄ±larÄ±n **titleFilter** dizesini girebilmesi iÃ§in,

**`<h1>Index</h1>`** baÅŸlÄ±ÄŸÄ±nÄ±n altÄ±na ÅŸu **HTML** kodunu ekle:

```html
<div>
    <form action="/movies" data-enhance>
        <input type="search" name="titleFilter" />
        <input type="submit" value="Search" />
    </form>
</div>
```

### AÃ§Ä±klama:

* **`data-enhance`** niteliÄŸi, Blazorâ€™un **GET** isteÄŸini yakalayÄ±p **fetch isteÄŸine** dÃ¶nÃ¼ÅŸtÃ¼rmesini saÄŸlar.

  Blazor yanÄ±tÄ± alÄ±r ve yalnÄ±zca ilgili sayfa kÄ±smÄ±nÄ± gÃ¼nceller.

  BÃ¶ylece:

  * Sayfa  **tamamen yenilenmez** ,
  * **KaydÄ±rma konumu** korunur,
  * **Sayfa daha hÄ±zlÄ±** yÃ¼klenir.

TarayÄ±cÄ± penceresini kapatmadan,  **VS Code** â€™da **Run > Restart Debugging** seÃ§eneÄŸini tÄ±klayarak veya **Ctrl+Shift+F5** tuÅŸlarÄ±na basarak uygulamayÄ± yeniden baÅŸlat.

VS Code, kaydedilen deÄŸiÅŸikliklerle uygulamayÄ± yeniden derleyip Ã§alÄ±ÅŸtÄ±rÄ±r.

---

## ğŸ” Arama kutusunu test et

Arama kutusuna **"Road Warrior"** yaz ve **Search** dÃ¼ÄŸmesine tÄ±kla.

Filmler filtrelenir ve yalnÄ±zca eÅŸleÅŸen kayÄ±t gÃ¶rÃ¼ntÃ¼lenir.

---

## ğŸ“‹ Road Warrior aramasÄ±ndan sonraki sonuÃ§:

**"The Road Warrior"** filmi, HTML formu Ã¼zerinden yapÄ±lan **GET** isteÄŸiyle filtrelenmiÅŸ olarak gÃ¶rÃ¼ntÃ¼lenir.

---

## ğŸ’¾ Arama deÄŸerini koruma

Filmler filtrelendiÄŸinde arama kutusundaki deÄŸer ( **"Road Warrior"** ) kaybolur.

Bunun korunmasÄ± iÃ§in forma **data-permanent** niteliÄŸini ekle:

```diff
- <form action="/movies" data-enhance>
+ <form action="/movies" data-enhance data-permanent>
```

---

## ğŸ›‘ UygulamayÄ± durdurma

UygulamayÄ± durdurmak iÃ§in tarayÄ±cÄ± penceresini kapat

ve  **VS Code** â€™da **Shift+F5** tuÅŸlarÄ±na bas.

---

## ğŸ§© Sorun giderme

EÄŸer Ã¶ÄŸreticide ilerlerken Ã§Ã¶zemediÄŸin bir sorunla karÅŸÄ±laÅŸÄ±rsan, kodunu tamamlanmÄ±ÅŸ Ã¶rnek proje ile karÅŸÄ±laÅŸtÄ±r:

ğŸ”— **Blazor Ã¶rnekleri GitHub deposu (dotnet/blazor-samples)**

En son sÃ¼rÃ¼m klasÃ¶rÃ¼nÃ¼ seÃ§.

Bu Ã¶ÄŸreticiye ait Ã¶rnek projenin klasÃ¶r adÄ±: **BlazorWebAppMovies**

---

## ğŸ“š Ek kaynaklar

* [LINQ belgeleri](https://learn.microsoft.com/dotnet/csharp/programming-guide/concepts/linq/)
* [Veri sorgulamak iÃ§in C# LINQ sorgularÄ± yazma (C# belgeleri)](https://learn.microsoft.com/dotnet/csharp/programming-guide/concepts/linq/write-linq-queries)
* [Lambda ifadeleri (C# belgeleri)](https://learn.microsoft.com/dotnet/csharp/lambda-expressions)
